<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .container {
            /* display: flex;
            flex-direction: column; */
        }

        img {
            width: 100%;
            height: 300px;
        }
    </style>
</head>

<body>
    <div class="container" style="height: 100vh; overflow: scroll;" id="container">
        <img data-src="https://images.pexels.com/photos/106399/pexels-photo-106399.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500">
        <img data-src="https://images.pexels.com/photos/1370704/pexels-photo-1370704.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500">
        <img data-src="https://images.pexels.com/photos/2501965/pexels-photo-2501965.jpeg?auto=compress&cs=tinysrgb&dpr=3&h=750&w=1260">
        <img data-src="https://images.pexels.com/photos/1115804/pexels-photo-1115804.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500">
        <img data-src="https://images.pexels.com/photos/250659/pexels-photo-250659.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500">
        <img data-src="https://images.pexels.com/photos/688835/pexels-photo-688835.jpeg?auto=compress&cs=tinysrgb&dpr=2&w=500">
    </div>
</body>
<script>
    const imgs = [...document.getElementsByTagName('img')];
    let n = 0;

    lazyload();

    // 防抖节流： 滚动是一个连续的事件，这里要是已经开始执行，即计时器已经启动则不进行操作，200ms内只执行一次
    function throttle(fn, wait) {
        let timer = null;
        return function (...args) {
            if (!timer) {
                timer = setTimeout(() => {
                    timer = null;
                    fn.apply(this, args)
                }, wait)
            }
        }
    }

    function lazyload() {
        var innerHeight = window.innerHeight;
        // var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        // const container = document.getElementById('container')
        innerHeight = document.getElementById('container').offsetHeight
        var scrollTop = document.getElementById('container').scrollTop
        for (let i = n; i < imgs.length; i++) {
            console.log(`加载第${i}张图片当前n的值${n}`, imgs[i].offsetTop, innerHeight, scrollTop)
            if (imgs[i].offsetTop < innerHeight + scrollTop) {
                console.log('符合条件', i)
                imgs[i].src = imgs[i].getAttribute("data-src");
                n = i + 1;
            }

        }
    }
    // window.addEventListener('scroll', throttle(lazyload, 200));
    document.getElementById('container').addEventListener('scroll', throttle(lazyload, 200));

</script>

</html>